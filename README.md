# Overview

This is a add-on designed to export from the Anki flashcard software desktop
application (Anki) all information necessary to recreate the statistical
reports that are available in the `Stats` window of Anki. The export must
be done on the same day the `Stats` window is opened for results to match
(where 'same day' is with respect to the rollover hour configured in Anki that
defines day boundaries).

This is a modification of add-on [export cards/notes from browser with
metadata to csv or xlsx](https://ankiweb.net/shared/info/1967530655) (updated:
2024-03-28) (the 'original add-on').

# Modifications From Original
Below is a high-level summary of modifications to the original add-on. This
list may not be exhaustive.
- Ability to export the raw values of FSRS retrievability, difficulty, and
  stability was added. For example, the latter two are exported with three
  decimal digits of precision to match the values as stored in the database.
  These values are currently available in the original add-on only by downloading
  the rounded fields displayed in the browser.
- The ability to export the following variables was added:
  - Last interval (`lastivl`) for each review. This is used to differentiate
    between `Young` and `Mature` reviews for reporting.
  - Days elapsed since collection start (`col_TodayDaysElapsed`). This is used
    to determine the day a review is due when `due`/`odue` is not recorded
    as a time stamp.
  - Collection rollover hour (`col_RolloverHour`). This is used to assign
    date/times to the correct day (adjusted for rollover).
- Fields are now for the most part passed out without modification. For example:
  - The database field `card.due` is passed in the `c_due` field. There is no
    attempt to determine when this represents a local datetime and to then 
    convert it to such a date-time value.
  - Datetime values stored in the database as milli-seconds are not divided by
    1000 or converted to time-stamps.
- Most fields not necessary to recreate the `Stats` window are removed to simplify
  the code. These might be re-added in the future. However, the lapse and review
  counts are retained, and the ability to export columns viewed in the browser is
  also retained.
- Output variable names were sometimes changed. In particular, `c_var` is now
  used when outputting `card.var`, i.e, the `var` attribute of the Python `card`
  object.
- Code for writing to Excel-formatted output (xlsx files) is removed.
- HTML can no longer by removed from output during the export. The functions
  that perform these operations are kept in the module, so users can call these
  if desired when post-processing the export file.
- Function names that generated deprecation warnings were updated.
- `meta.json` was removed. It's unclear if this is an old file format required
  by AnkiWeb or something that will be generated by AnkiWeb. In any case, the
  AnkiWeb documentation now makes reference to `manifest.json`.
- Code standardized using `pylint`.

# Using the Output
An example Python program that shows how to recreate (in tabular form) the
charts and tables in the `Stats` window is
[here](https://github.com/ghrgriner/anki-stats). The same repository also
contains a [wiki](https://github.com/ghrgriner/anki-stats/wiki) with
documentation on the analysis population used in each report in the `Stats`
window.
